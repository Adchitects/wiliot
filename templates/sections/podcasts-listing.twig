{% set podcasts = craft.entries.section('podcastDetails').orderBy('postDate desc') %}
{% set title = entry.podcastsListingTitle %}
{% set logo = entry.podcastsListingLogo.one() %}
{% set subtitle = entry.podcastsListingSubtitle %}
{% if podcasts %}
	<section {% if sectionId is defined %} id="{{ sectionId }}" {% endif %} class="u-section u-section--podcasts-listing">
		<div class="u-wrapper">
			<div class="podcasts-listing js-load-more-hld">
				{% if logo is not null %}
					<img src="{{ logo.getUrl() }}" alt="Mr. Beacon Podcast" class="podcasts-listing__logo">
				{% endif %}
				<div class="podcasts-listing__header">
					<h1 style="display: none; opacity: 0;">The Mr. Beacon Podcast</h1>
					{% if subtitle %}
						<span class="u-subtitle u-subtitle--section">{{ subtitle }}</span>
					{% endif %}
					{% if title %}
						<h2 class="u-title u-title--section">{{ title }}</h2>
					{% endif %}
				</div>
				<div class="podcasts-listing__items">
					{% if podcasts|length %}
						{% for post in podcasts.all() %}
							{% set image = post.podcastDetailsImage.one() %}
							{% set videoId = post.podcastDetailsID %}
							{% set excerpt = post.podcastDetailsExcerpt %}
							{% set excerptSliced = excerpt|slice(0, 107) ~ '...' %}
							{% set number = post.podcastDetailsNumber %}
							{% if image %}
								{% set imageUrl = image.getUrl('latestPostThumb') %}
								{% set imageWidth = image.getWidth() %}
								{% set imageHeight = image.getHeight() %}
								{% set imageAlt = image.title %}
							{% endif %}
							{% set title = post.title %}
							{% set podcastDetailsIframeTitle = post.podcastDetailsIframeTitle ? post.podcastDetailsIframeTitle : podcastsGlobals.podcastDetailsIframeTitle %}
							{% set podcastDetailsIframeWidget = post.podcastDetailsIframeWidget %}
							<div class="post js-load-more-item js-modal-hld" data-max-items="3" data-load-items="3">
								<div class="post__image-hld js-modal-btn is-paused">
									{% if image %}
										<img class="js-lazy" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 3 2'%3E%3C/svg%3E" data-src="{{ imageUrl }}" alt="{{ imageAlt }}" />
										<span class="icon icon-button_play"></span>
									{% endif %}
								</div>
								<a href="{{ post.url}}" class="post__text-hld">
									<div class="post__date">
										Episode #{{number}}
										{{ post.postDate | date("F d, Y") }}</div>
									<div class="post__title">{{ title }}</div>
									{% if excerpt %}
										<div class="post__excerpt">{{ excerpt|length > 110 ? excerptSliced|raw : excerpt|raw }}</div>
									{% endif %}
								</a>
								<div class="post__widget-title">{{ podcastDetailsIframeTitle }}</div>
								{% if podcastDetailsIframeWidget %}
									<div class="post__widget-hld">
										{{ podcastDetailsIframeWidget|raw }}
									</div>
								{% endif %}
								<a href="{{ post.url}}" class="post__btn u-btn u-btn--arrow">
									<span class="text">See details</span>
								</a>
								<div class="video-modal js-modal-modal">
									<div class="overlay js-modal-close"></div>
									<div class="video-modal__inner">
										<div class="video-modal__modal">
											<iframe width="560" height="315" class="js-lazy js-modal-iframe" data-src="https://www.youtube.com/embed/{{ videoId }}?rel=1&amp;autoplay=1&amp;playlist={{ videoId }}&amp;origin=https://www.wiliot.com" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
										</div>
										<span class="video-modal__close js-modal-close">
											<span class="icon icon-close"></span>
										</span>
									</div>
								</div>
							</div>
						{% endfor %}
					{% endif %}
				</div>
				{% if podcasts|length > 3 %}
				<button class="podcasts-listing__btn u-btn u-btn--light js-load-more-btn">
					<span class="text">
						More podcasts
					</span>
				</button>
				{% endif %}
			</div>
		</div>
	</section>
{% endif %}

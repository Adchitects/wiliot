{% set podcasts = craft.entries.section('podcastDetails').order('postDate desc') %}
{% set title = entry.podcastsListingTitle %}
{% set logo = entry.podcastsListingLogo.one() %}
{% set subtitle = entry.podcastsListingSubtitle %}

{% if podcasts %}
	<section class="u-section u-section--podcasts-listing">
		<div class="u-wrapper">
			<div class="podcasts-listing js-load-more-hld">
				{% if logo is not null %}
					<img src="{{ logo.getUrl() }}" alt="Mr. Beacon Podcast" class="podcasts-listing__logo">
				{% endif %}
				<div class="podcasts-listing__header">
					{% if subtitle %}
						<span class="u-subtitle u-subtitle--section">{{subtitle}}</span>
					{% endif %}
					{% if title %}
						<h2 class="u-title u-title--section">{{ title }}</h2>
					{% endif %}
				</div>
				<div class="podcasts-listing__items">
					{% if podcasts|length %}
						{% for post in podcasts %}
							{% set image = post.podcastDetailsImage.one() %}
							{% set excerpt = post.podcastDetailsExcerpt %}
							{% set number = post.podcastDetailsNumber %}
							{% if image %}
								{% set imageUrl = image.getUrl() %}
								{% set imageWidth = image.getWidth() %}
								{% set imageHeight = image.getHeight() %}
								{% set imageAlt = image.title %}
							{% endif %}
							{% set title = post.title %}
							<a href="{{ post.url}}" class="post js-load-more-item" data-max-items="3" data-load-items="3">
								<div class="post__image-hld">
									{% if image %}
										<img class="js-lazy" data-src="{{ imageUrl }}" alt="{{ imageAlt }}" width="{{ imageWidth }}" height="{{ imageHeight }}"/>
									{% else %}
										<img class="js-lazy" data-src="{{ alias('@web/src/img/placeholder.jpg') }}" width="300" height="225" alt="Wiliot placeholder image">
									{% endif %}
								</div>
								<div class="post__date">
									<span>Episode #{{number}}</span>
									{{ post.postDate | date("F d, Y") }}</div>
								<div class="post__title">{{ title}}</div>
								{% if image %}
									<div class="post__excerpt">{{ excerpt}}</div>
								{% endif %}
								<div class="post__btn u-btn u-btn--arrow">
									<span class="text">Watch</span>
								</div>
							</a>
						{% endfor %}
					{% endif %}
				</div>
				<button class="podcasts-listing__btn u-btn u-btn--light js-load-more-btn">
					<span class="text">
						More Podcasts
					</span>
				</button>
			</div>
		</div>
	</section>
{% endif %}
